# LOTL Detector Configuration
# 
# This is the main configuration file for the LOTL detector.
# Modify settings here to customize behavior.

# Operational mode: bootstrap, learn, enforce, paranoid
# - bootstrap: Log only, no alerts, collect baseline (first 24h)
# - learn: Alert anomalies, block Tier 1 only (default after bootstrap)
# - enforce: Full blocking + alerts
# - paranoid: Block everything suspicious
mode: bootstrap

# Logging configuration
logging:
  level: INFO
  directory: /var/log/lotl
  max_size_mb: 100
  backup_count: 5
  syslog_enabled: true
  syslog_facility: local0

# Database configuration
database:
  path: /var/lib/lotl/detector.db
  max_age_days: 30
  vacuum_interval_hours: 24

# Baseline learning configuration
baseline:
  bootstrap_duration_hours: 24
  learn_duration_days: 7
  decay_half_life_days: 7
  anomaly_threshold: 2.0

# Blocking behavior
blocking:
  # Paths blocked at kernel level (Tier 1)
  tier1_paths: []
  # Automatically add inodes for tier1 paths
  tier1_inodes_from_paths: true
  # Block execution from memfd/anonymous memory
  block_memfd_exec: true
  # Block execution from stdin
  block_stdin_exec: true

# Ancestry allowlist
ancestry:
  enabled: true
  # Maximum window for ancestry (seconds)
  window_seconds: 300
  # Processes that can spawn children without triggering alerts
  allowed_ancestors:
    - /usr/bin/apt
    - /usr/bin/apt-get
    - /usr/bin/dpkg
    - /usr/bin/yum
    - /usr/bin/dnf
    - /usr/bin/pacman

# Health monitoring
health:
  metrics_path: /var/run/lotl/metrics.json
  check_interval_seconds: 30

# Paths to rule files
rules_dir: /etc/lotl/rules

# Runtime state directory
run_dir: /var/run/lotl
panic_file: DISABLE

